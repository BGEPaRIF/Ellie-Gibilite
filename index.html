<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Outil d'√âligibilit√© - BGE PaRIF</title>

  <!-- React (global) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel (pour JSX dans un fichier HTML) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Police -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Poppins', sans-serif; }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo } = React;

    // Petit helper: rend URLs + emails cliquables dans un texte
    function ClickableText({ text }) {
      if (!text) return null;

      const urlRegex = /(https?:\/\/[^\s]+)/g;
      const emailRegex = /([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/g;

      let parts = [text];

      // URLs
      parts = parts.flatMap((part) => {
        if (typeof part !== "string") return part;
        return part.split(urlRegex).map((seg, i) => {
          if (urlRegex.test(seg)) {
            return (
              <a
                key={"url-" + i}
                href={seg}
                target="_blank"
                rel="noopener noreferrer"
                className="text-blue-600 hover:text-blue-800 underline inline-flex items-center"
              >
                {seg} <span className="ml-1">‚Üó</span>
              </a>
            );
          }
          return seg;
        });
      });

      // Emails
      parts = parts.flatMap((part) => {
        if (typeof part !== "string") return part;
        return part.split(emailRegex).map((seg, i) => {
          if (emailRegex.test(seg)) {
            return (
              <a
                key={"email-" + i}
                href={"mailto:" + seg}
                className="text-blue-600 hover:text-blue-800 underline"
              >
                {seg}
              </a>
            );
          }
          return seg;
        });
      });

      return <>{parts}</>;
    }

    function EligibilityTool() {
      const [step, setStep] = useState(0);
      const [answers, setAnswers] = useState({});
      const [results, setResults] = useState(null);

      const getQuestions = () => {
        const q = [];

        // 1) Projet / entreprise
        q.push({
          id: "entrepriseCreee",
          question: "Avez-vous d√©j√† cr√©√© votre entreprise ?",
          type: "radio",
          options: ["Oui", "Non"],
        });

        if (answers.entrepriseCreee === "Oui") {
          q.push({
            id: "typeEntreprise",
            question: "Quel est le statut juridique de votre entreprise ?",
            type: "radio",
            options: ["Micro-entreprise", "Soci√©t√© (SARL, SAS, etc.)"],
          });

          q.push({
            id: "ageEntreprise",
            question: "Depuis combien de temps existe-t-elle ?",
            type: "radio",
            options: ["Moins de 3 ans", "Plus de 3 ans"],
          });

          if (answers.typeEntreprise === "Soci√©t√© (SARL, SAS, etc.)") {
            q.push({
              id: "caAnnuel",
              question: "Quel est votre chiffre d'affaires annuel ?",
              type: "radio",
              options: ["Moins de 30 000 ‚Ç¨", "Plus de 30 000 ‚Ç¨"],
            });
          }
        }

        if (answers.entrepriseCreee === "Non") {
          q.push({
            id: "stadeProjet",
            question: "√Ä quel stade en est votre projet ?",
            type: "radio",
            options: ["Id√©e", "Projet formalis√©", "Business plan finalis√©"],
          });

          if (answers.stadeProjet === "Projet formalis√©") {
            q.push({
              id: "projetImpact",
              question:
                "Votre projet est-il consid√©r√© comme projet √† impact (social et/ou environnemental) ?",
              type: "radio",
              options: ["Oui", "Non"],
            });
          }

          if (
            answers.stadeProjet === "Projet formalis√©" ||
            answers.stadeProjet === "Business plan finalis√©"
          ) {
            q.push({
              id: "activiteReglementee",
              question:
                "Votre projet concerne-t-il l'une des activit√©s suivantes : activit√© lib√©rale r√©glement√©e ou assimil√©e, activit√©s immobili√®res, secteur m√©dical et m√©dico-social, activit√©s financi√®res et d'assurance, production agricole primaire, p√™che, aquaculture, sylviculture ?",
              type: "radio",
              options: ["Oui", "Non"],
            });
          }
        }

        // 2) Infos perso
        q.push({
          id: "sexe",
          question: "Vous √™tes :",
          type: "radio",
          options: ["Une femme", "Un homme"],
        });

        q.push({
          id: "age",
          question: "Quel est votre √¢ge ?",
          type: "number",
          placeholder: "Ex: 30",
        });

        const age = parseInt(answers.age, 10) || 0;
        if (age >= 18 && age <= 30) {
          q.push({
            id: "missionLocale",
            question: "√ätes-vous inscrit(e) aupr√®s d'une Mission Locale ?",
            type: "radio",
            options: ["Oui", "Non"],
          });
        }

        q.push({
          id: "codePostal",
          question: "Quel est votre code postal de r√©sidence ?",
          type: "text",
          placeholder: "Ex: 75001",
        });

        q.push({
          id: "qpv",
          question:
            "R√©sidez-vous en Quartier Prioritaire de la Ville (QPV) ou dans un rayon de 300 m√®tres autour ?",
          type: "radio",
          options: ["Oui", "Non", "Je ne sais pas"],
          info: "Vous pouvez v√©rifier sur https://sig.ville.gouv.fr/",
        });

        // 3) Parcours / situation
        q.push({
          id: "niveauEtude",
          question: "Quel est votre niveau d'√©tude ?",
          type: "radio",
          options: ["Inf√©rieur au CAP/BEP", "CAP/BEP", "Baccalaur√©at", "Bac+2 et plus"],
        });

        q.push({
          id: "statut",
          question: "Quel est votre statut actuel ?",
          type: "checkbox",
          options: [
            "Demandeur d'emploi",
            "Salari√© √† temps complet",
            "Salari√© √† temps partiel",
            "B√©n√©ficiaire RSA",
            "B√©n√©ficiaire ASS",
            "B√©n√©ficiaire AAH",
          ],
        });

        if (answers.statut?.includes("Demandeur d'emploi")) {
          q.push({
            id: "dureeDemandeurEmploi",
            question: "Depuis combien de temps √™tes-vous demandeur d'emploi ?",
            type: "radio",
            options: ["Moins de 12 mois", "De 12 √† 24 mois", "Plus de 24 mois"],
          });
        }

        // (Corrig√©) On pose toujours la question France Travail, c'est coh√©rent et √©vite le bug
        q.push({
          id: "inscritFranceTravail",
          question: "√ätes-vous inscrit(e) √† France Travail ?",
          type: "radio",
          options: ["Oui", "Non"],
        });

        // 4) Crit√®res sp√©cifiques
        q.push({
          id: "criteresSociaux",
          question: "Cochez toutes les situations qui vous concernent :",
          type: "checkbox",
          options: [
            "Parent isol√©",
            "Sans domicile fixe (SDF)",
            "R√©cemment arriv√© en France",
            "Sortant de l'ASE (Aide Sociale √† l'Enfance)",
            "R√©sidence en ZRR (Zone de Revitalisation Rurale)",
            "Aucun de ces crit√®res",
          ],
        });

        q.push({
          id: "handicap",
          question: "√ätes-vous reconnu(e) travailleur(se) en situation de handicap (RQTH) ?",
          type: "radio",
          options: ["Oui", "Non"],
        });

        if (answers.handicap === "Oui") {
          q.push({
            id: "inscritCapEmploi",
            question: "√ätes-vous inscrit(e) √† Cap Emploi ?",
            type: "radio",
            options: ["Oui", "Non"],
          });
        }

        q.push({
          id: "sortieIAE",
          question:
            "√ätes-vous sorti(e) d'un dispositif IAE (Insertion par l'Activit√© √âconomique) depuis moins de 6 mois ?",
          type: "radio",
          options: ["Oui", "Non"],
        });

        q.push({
          id: "cpf",
          question: "Disposez-vous de cr√©dits CPF (Compte Personnel de Formation) ?",
          type: "radio",
          options: ["Oui", "Non", "Je ne sais pas"],
          info:
            "Pour le d√©couvrir, connectez-vous √† votre espace personnel sur www.moncompteformation.gouv.fr",
        });

        return q;
      };

      const questions = useMemo(() => getQuestions(), [answers]);
      const currentQuestion = questions[step];

      const isAnswered =
        currentQuestion &&
        answers[currentQuestion.id] !== undefined &&
        answers[currentQuestion.id] !== "" &&
        (Array.isArray(answers[currentQuestion.id])
          ? answers[currentQuestion.id].length > 0
          : true);

      const handleAnswer = (questionId, value) => {
        // Si "Aucun de ces crit√®res" est coch√© -> on nettoie les autres
        if (questionId === "criteresSociaux" && Array.isArray(value)) {
          if (value.includes("Aucun de ces crit√®res") && value.length > 1) {
            value = ["Aucun de ces crit√®res"];
          }
        }
        setAnswers((prev) => ({ ...prev, [questionId]: value }));
      };

      const calculateEligibility = () => {
        const eligible = [];
        const a = answers;

        const age = parseInt(a.age, 10) || 0;

        const isQPV = a.qpv === "Oui" || a.qpv === "Je ne sais pas";
        const isDept75 = (a.codePostal || "").startsWith("75");
        const isDept93 = (a.codePostal || "").startsWith("93");
        const isIDF = ["75", "77", "78", "91", "92", "93", "94", "95"].some((d) =>
          (a.codePostal || "").startsWith(d)
        );

        const entrepriseCreee = a.entrepriseCreee === "Oui";
        const isJeune = age >= 18 && age <= 30;
        const isSenior = age >= 50;

        const isRSA = a.statut?.includes("B√©n√©ficiaire RSA");
        const isASS = a.statut?.includes("B√©n√©ficiaire ASS");
        const isAAH = a.statut?.includes("B√©n√©ficiaire AAH");
        const isDemandeurEmploi = a.statut?.includes("Demandeur d'emploi");
        const isSalariePleinTemps = a.statut?.includes("Salari√© √† temps complet");

        const isDETLD = a.dureeDemandeurEmploi === "Plus de 24 mois";
        const isDELD = a.dureeDemandeurEmploi === "De 12 √† 24 mois";

        const niveauEtudeInferieur = ["Inf√©rieur au CAP/BEP", "CAP/BEP"].includes(a.niveauEtude);

        const codesPostIncubatest = [
          "95400","95500","95720","95380","77410","77290","77230","95440","95190","95470","95140","77990","95670",
          "77280","95700","95200","77270","91120","91140","91160","91190","91300","91310","91320","91360","91370",
          "91400","91430","91440","91460","91620","91940","91800","91860","91560","91210","91480","91270","91330",
          "75001","75002","75003","75004","75005","75006","75007","75008","75009","75010","75011","75012","75013",
          "75014","75015","75016","75017","75018","75019","75020"
        ];
        const isVilleIncubatest = codesPostIncubatest.includes(a.codePostal);

        // 1. Acc√©l√©rateur √âmergence
        if (
          !entrepriseCreee &&
          (a.stadeProjet === "Id√©e" || a.stadeProjet === "Projet formalis√©") &&
          isQPV &&
          !isSalariePleinTemps
        ) {
          eligible.push({
            nom: "Acc√©l√©rateur √âmergence",
            description:
              "Programme d'accompagnement intensif destin√© aux porteurs de projet au stade de l'id√©e ou du projet.",
            duree: "Environ 200 heures sur 6 mois",
            contenu: ["Plus de 100 heures de formation", "Accompagnement individuel", "Ateliers collectifs", "Mise en r√©seau"],
            enSavoirPlus: "https://emergence.bge-parif.com",
            procedure: "Prendre contact : accelerateurs@bge-parif.com",
            note: "Dispositif s√©lectif - s√©lection apr√®s √©tude du dossier",
          });
        }

        // 2. Acc√©l√©rateur Cr√©ation Individuelle
        if (entrepriseCreee && isQPV) {
          const ageOk = a.ageEntreprise === "Moins de 3 ans";
          const caOk =
            a.typeEntreprise === "Micro-entreprise" || a.caAnnuel === "Moins de 30 000 ‚Ç¨";
          if (ageOk && caOk) {
            eligible.push({
              nom: "Acc√©l√©rateur Cr√©ation Individuelle",
              description:
                "Programme sur-mesure pour les entrepreneurs en d√©veloppement souhaitant structurer leur activit√©.",
              duree: "Environ 250 heures sur 12 mois",
              contenu: ["Formation", "Accompagnement individuel", "Ateliers collectifs", "Mise en r√©seau"],
              enSavoirPlus: "https://creation-individuelle.bge-parif.com/",
              procedure: "Prendre contact : accelerateurs@bge-parif.com",
              note: "Dispositif s√©lectif - s√©lection apr√®s √©tude du dossier",
            });
          }
        }

        // 3. Formations certifiantes
        if (a.cpf === "Oui" || a.cpf === "Je ne sais pas") {
          eligible.push({
            nom: "Formations Certifiantes",
            description:
              "Formations certifiantes pour d√©velopper des comp√©tences entrepreneuriales (finan√ßables via CPF).",
            duree: "Variable selon la formation",
            contenu: [
              "CCPE ‚Äì 95h",
              "DVRS ‚Äì 14h",
              "Piloter sa micro-entreprise ‚Äì 21h",
            ],
            procedure:
              "S'inscrire via https://www.bge-parif.com/agenda/ ou prendre RDV : https://calendly.com/bgeparif/conseil-formation-entrepreneurial-1",
            note:
              a.cpf === "Je ne sais pas"
                ? "Connectez-vous sur www.moncompteformation.gouv.fr pour conna√Ætre votre solde."
                : "Finan√ßable par vos cr√©dits CPF.",
          });
        }

        // 4. G√©n√©rateur √† Impact
        if (!entrepriseCreee && a.stadeProjet === "Projet formalis√©" && a.projetImpact === "Oui" && isDept75) {
          eligible.push({
            nom: "G√©n√©rateur √† Impact",
            description:
              "Accompagnement pour structurer votre mod√®le et strat√©gie (projets √† impact √† Paris).",
            duree: "Environ 28 heures",
            contenu: ["Ateliers orient√©s impact", "RDV individuels", "Business model", "Pitch deck"],
            enSavoirPlus: "https://www.bge-parif.com/structurer-votre-projet/incubateur-parisien-le-generateur-a-impact/",
            procedure: "S'inscrire via https://www.bge-parif.com/agenda/",
            note: "R√©serv√© aux projets √† impact dans le d√©partement 75",
          });
        }

        // 5. Incubatest
        if (
          !entrepriseCreee &&
          (a.stadeProjet === "Projet formalis√©" || a.stadeProjet === "Business plan finalis√©") &&
          isVilleIncubatest &&
          a.activiteReglementee === "Non" &&
          !isSalariePleinTemps
        ) {
          eligible.push({
            nom: "Incubatest",
            description:
              "Tester votre activit√© en couveuse dans un cadre s√©curis√© (entrepreneur √† l'essai).",
            duree: "6 √† 8 mois",
            contenu: ["RDV individuels", "Formations", "Appui commercial", "Gestion"],
            enSavoirPlus: "https://www.bge-parif.com/tester-votre-activite-en-couveuse-incubatest/",
            procedure: "S'inscrire via https://www.bge-parif.com/agenda/",
            note: "Exclu pour activit√©s r√©glement√©es",
          });
        }

        // 6. Cr√©er Sa R√©ussite
        if (!entrepriseCreee) {
          let criteresN2 = 0;

          const criteresSociaux = a.criteresSociaux || [];
          const has = (x) => criteresSociaux.includes(x);

          if (niveauEtudeInferieur) criteresN2++;
          if (isSenior) criteresN2++;
          if (isDELD) criteresN2++;
          if (isQPV || has("R√©sidence en ZRR (Zone de Revitalisation Rurale)")) criteresN2++;
          if (has("Sans domicile fixe (SDF)")) criteresN2++;
          if (has("Parent isol√©")) criteresN2++;
          if (has("R√©cemment arriv√© en France")) criteresN2++;

          const porte1 = (isRSA || isASS || isAAH) || isDETLD;
          const porte2 = criteresN2 >= 3;
          const porte3 = isJeune && (a.missionLocale === "Oui" || has("Sortant de l'ASE (Aide Sociale √† l'Enfance)") || criteresN2 >= 1);
          const porte4 = a.handicap === "Oui" && (a.inscritCapEmploi === "Oui" || criteresN2 >= 1);
          const porte5 = a.sortieIAE === "Oui";

          if (porte1 || porte2 || porte3 || porte4 || porte5) {
            eligible.push({
              nom: "Cr√©er Sa R√©ussite",
              description:
                "Programme d'accompagnement personnalis√© pour faciliter la cr√©ation / reprise d'entreprise (publics prioritaires).",
              duree: "Jusqu'√† 10h",
              contenu: ["Entretiens individuels", "Ateliers collectifs", "Compl√©ments de parcours"],
              enSavoirPlus: "https://www.bge-parif.com/structurer-votre-projet/creer-sa-reussite/",
              procedure: "Contacter : contact@bge-parif.com / 01 43 55 09 48",
              note: "Programme adapt√© aux publics prioritaires",
            });
          }
        }

        // 7. PDI 75
        if ((isRSA || isASS) && isDETLD && isDept75 && !entrepriseCreee) {
          eligible.push({
            nom: "PDI 75",
            description:
              "Programme d'insertion (Paris) pour b√©n√©ficiaires RSA/ASS en DETLD, incluant accompagnement cr√©ation d'entreprise.",
            duree: "7 √† 8 heures",
            contenu: ["Accompagnement individuel par un conseiller expert"],
            procedure: "Via conseiller insertion / France Travail ou contact@bge-parif.com",
            note: "R√©serv√© aux b√©n√©ficiaires RSA/ASS en DETLD dans le 75",
          });
        }

        // 8. PDI 93
        if ((isRSA || isASS) && isDETLD && isDept93 && !entrepriseCreee) {
          eligible.push({
            nom: "PDI 93",
            description:
              "Programme d'insertion (Seine-Saint-Denis) pour b√©n√©ficiaires RSA/ASS en DETLD, incluant accompagnement cr√©ation d'entreprise.",
            duree: "7 √† 8 heures",
            contenu: ["Accompagnement individuel par un conseiller expert"],
            procedure: "Via conseiller insertion / France Travail ou contact@bge-parif.com",
            note: "R√©serv√© aux b√©n√©ficiaires RSA/ASS en DETLD dans le 93",
          });
        }

        // 9. Accompagnement Renforc√©
        if (!entrepriseCreee && (a.stadeProjet === "Projet formalis√©" || a.stadeProjet === "Business plan finalis√©") && isQPV) {
          eligible.push({
            nom: "Accompagnement Renforc√©",
            description:
              "Soutien aux porteurs de projet / entrepreneurs en QPV (parcours individuel ou collectif).",
            duree: "10 heures",
            contenu: ["Plan d'action", "Business plan", "Choix juridique", "Financement", "Gestion"],
            procedure: "Contacter : contact@bge-parif.com / 01 43 55 09 48",
            note: "R√©serv√© aux projets formalis√©s en QPV",
          });
        }

        // 10. AGEFIPH
        if (a.handicap === "Oui" && !entrepriseCreee && a.stadeProjet !== "Id√©e") {
          eligible.push({
            nom: "AGEFIPH",
            description:
              "Accompagnement cr√©ation d'entreprise pour personnes en situation de handicap (via Cap Emploi / France Travail).",
            duree: "Jusqu'√† 25h (ante) + 15h (post) sur 3 ans",
            contenu: ["Montage du projet", "D√©marrage", "Suivi"],
            procedure: "Se rapprocher de Cap Emploi ou France Travail",
            note: "Reconnaissance RQTH obligatoire",
          });
        }

        // 11. Pass Entrepreneur #Leader 1
        const exclusLeader1 = (a.sexe === "Un homme" && isSalariePleinTemps && age > 30);
        const activiteExclueLeader = a.activiteReglementee === "Oui";

        if (age >= 18 && isIDF && a.stadeProjet !== "Id√©e" && !entrepriseCreee && !exclusLeader1 && !activiteExclueLeader) {
          eligible.push({
            nom: "Pass Entrepreneur #Leader 1",
            description: "Accompagnement individuel pour porteurs de projet en phase de cr√©ation (√éle-de-France).",
            duree: "Entre 3 et 7 heures",
            contenu: ["Plan d'action", "Business plan", "Statut", "Gestion", "Financement"],
            procedure: "Compl√©ter le formulaire : https://airtable.com/appH6ML4Ix5hyPhQQ/shrYF8iz0OnKJMYlC",
            note: "Financ√© par la R√©gion √éle-de-France",
          });
        }

        // 12. Pass Entrepreneur #Leader 3
        if (entrepriseCreee && isIDF && a.ageEntreprise === "Moins de 3 ans" && !activiteExclueLeader) {
          eligible.push({
            nom: "Pass Entrepreneur #Leader 3",
            description: "Accompagnement individuel pour dirigeants en d√©veloppement (√éle-de-France).",
            duree: "Entre 3 et 7 heures",
            contenu: ["Pilotage", "Commercial", "R√©seau", "Recrutement", "S√©curisation"],
            procedure: "Compl√©ter le formulaire : https://airtable.com/appH6ML4Ix5hyPhQQ/shrQzKhqLuA531uOg",
            note: "Financ√© par la R√©gion √éle-de-France",
          });
        }

        // 13. Activ' Cr√©a √âmergence
        if (a.inscritFranceTravail === "Oui" && isDemandeurEmploi && a.stadeProjet === "Id√©e" && !entrepriseCreee) {
          eligible.push({
            nom: "Activ' Cr√©a √âmergence",
            description:
              "Parcours pour explorer la cr√©ation/reprise comme solution de retour √† l'emploi (France Travail).",
            duree: "Environ 2 mois",
            contenu: ["Diagnostic", "Ateliers", "RDV individuels", "Bilan"],
            procedure: "Via votre conseiller France Travail ou votre espace personnel sur https://www.francetravail.fr/accueil/",
            note: "Aide √† consolider une id√©e et √©valuer le profil entrepreneurial",
          });
        }

        setResults(eligible);
      };

      const handleNext = () => {
        if (step < questions.length - 1) setStep(step + 1);
        else calculateEligibility();
      };

      const handlePrevious = () => {
        if (step > 0) setStep(step - 1);
      };

      const handleReset = () => {
        setStep(0);
        setAnswers({});
        setResults(null);
      };

      // √âcran r√©sultats
      if (results !== null) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4">
            <div className="max-w-4xl mx-auto">
              <div className="bg-white rounded-2xl shadow-xl p-8">
                <h1 className="text-3xl font-bold text-gray-800 mb-6">
                  R√©sultats de votre √©ligibilit√©
                </h1>

                {results.length === 0 ? (
                  <div className="bg-orange-50 border border-orange-200 rounded-lg p-6 mb-6">
                    <div className="flex items-start gap-3">
                      <div className="text-2xl">‚ö†Ô∏è</div>
                      <div>
                        <h3 className="font-semibold text-orange-800 mb-2">
                          Aucun dispositif identifi√©
                        </h3>
                        <p className="text-orange-700">
                          Selon les informations fournies, aucun dispositif ne correspond exactement √† votre profil.
                          Contactez un conseiller pour une analyse plus fine.
                        </p>
                        <p className="text-orange-700 mt-3">
                          <strong>Contactez BGE PaRIF :</strong><br/>
                          üìß contact@bge-parif.com<br/>
                          üìû 01 43 55 09 48
                        </p>
                      </div>
                    </div>
                  </div>
                ) : (
                  <>
                    <div className="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                      <div className="flex items-center gap-2">
                        <div className="text-xl">‚úÖ</div>
                        <p className="text-green-800 font-semibold">
                          Vous √™tes √©ligible √† {results.length} dispositif{results.length > 1 ? "s" : ""} !
                        </p>
                      </div>
                    </div>

                    <div className="space-y-4 mb-8">
                      {results.map((d, index) => (
                        <div key={index} className="bg-white border-2 border-blue-200 rounded-xl p-6 hover:shadow-lg transition-all">
                          <h3 className="text-2xl font-bold text-blue-900 mb-3">{d.nom}</h3>

                          <p className="text-gray-700 leading-relaxed mb-4">{d.description}</p>

                          {d.duree && (
                            <div className="mb-3">
                              <span className="inline-block bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-sm font-semibold">
                                ‚è±Ô∏è {d.duree}
                              </span>
                            </div>
                          )}

                          {d.contenu?.length > 0 && (
                            <div className="mb-4">
                              <h4 className="font-semibold text-gray-800 mb-2">üìã Contenu :</h4>
                              <ul className="list-disc list-inside space-y-1 text-gray-600 ml-2">
                                {d.contenu.map((item, i) => <li key={i}>{item}</li>)}
                              </ul>
                            </div>
                          )}

                          {d.enSavoirPlus && (
                            <div className="mb-4">
                              <a
                                href={d.enSavoirPlus}
                                target="_blank"
                                rel="noopener noreferrer"
                                className="inline-flex items-center text-blue-600 hover:text-blue-800 font-semibold"
                              >
                                üîó En savoir plus <span className="ml-1">‚Üó</span>
                              </a>
                            </div>
                          )}

                          {d.procedure && (
                            <div className="mb-4 bg-green-50 border border-green-200 rounded-lg p-4">
                              <h4 className="font-semibold text-green-900 mb-2">üìû Comment s'inscrire :</h4>
                              <div className="text-green-800">
                                <ClickableText text={d.procedure} />
                              </div>
                            </div>
                          )}

                          {d.note && (
                            <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
                              <p className="text-amber-900 text-sm">
                                <strong>‚ÑπÔ∏è Note :</strong> {d.note}
                              </p>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  </>
                )}

                <button
                  onClick={handleReset}
                  className="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                >
                  üîÑ Recommencer le questionnaire
                </button>
              </div>
            </div>
          </div>
        );
      }

      // √âcran questionnaire
      if (!currentQuestion) {
        return (
          <div className="min-h-screen flex items-center justify-center">
            <div className="text-gray-700">Chargement‚Ä¶</div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-4">
          <div className="max-w-3xl mx-auto">
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <h1 className="text-3xl font-bold text-gray-800 mb-2">
                D√©couvrez les dispositifs d'accompagnement faits pour vous !
              </h1>
              <p className="text-gray-600 mb-6">
                En compl√©tant ce formulaire, nous identifions l'accompagnement le plus adapt√© √† votre situation.
              </p>

              <div className="mb-6">
                <div className="flex justify-between text-sm text-gray-600 mb-2">
                  <span>Question {step + 1} sur {questions.length}</span>
                  <span>{Math.round(((step + 1) / questions.length) * 100)}%</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-2">
                  <div
                    className="bg-indigo-600 h-2 rounded-full transition-all duration-300"
                    style={{ width: `${((step + 1) / questions.length) * 100}%` }}
                  ></div>
                </div>
              </div>

              <div className="mb-8">
                <h2 className="text-xl font-semibold text-gray-800 mb-4">
                  {currentQuestion.question}
                </h2>

                {currentQuestion.info && (
                  <div className="mb-4 bg-blue-50 border border-blue-200 rounded-lg p-3">
                    <p className="text-sm text-blue-700">üí° <ClickableText text={currentQuestion.info} /></p>
                    {currentQuestion.id === "qpv" && (
                      <a
                        href="https://sig.ville.gouv.fr/"
                        target="_blank"
                        rel="noopener noreferrer"
                        className="inline-flex items-center text-blue-600 hover:text-blue-800 text-sm font-semibold mt-2"
                      >
                        V√©rifier si vous √™tes en QPV <span className="ml-1">‚Üó</span>
                      </a>
                    )}
                  </div>
                )}

                {currentQuestion.type === "radio" && (
                  <div className="space-y-3">
                    {currentQuestion.options.map((option) => (
                      <label
                        key={option}
                        className="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors"
                        style={{
                          borderColor: answers[currentQuestion.id] === option ? "#4f46e5" : "#e5e7eb",
                          backgroundColor: answers[currentQuestion.id] === option ? "#eef2ff" : "white",
                        }}
                      >
                        <input
                          type="radio"
                          name={currentQuestion.id}
                          value={option}
                          checked={answers[currentQuestion.id] === option}
                          onChange={(e) => handleAnswer(currentQuestion.id, e.target.value)}
                          className="mr-3 w-5 h-5"
                        />
                        <span className="text-gray-700 font-medium">{option}</span>
                      </label>
                    ))}
                  </div>
                )}

                {currentQuestion.type === "checkbox" && (
                  <div className="space-y-3">
                    {currentQuestion.options.map((option) => (
                      <label
                        key={option}
                        className="flex items-center p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors"
                        style={{
                          borderColor: answers[currentQuestion.id]?.includes(option) ? "#4f46e5" : "#e5e7eb",
                          backgroundColor: answers[currentQuestion.id]?.includes(option) ? "#eef2ff" : "white",
                        }}
                      >
                        <input
                          type="checkbox"
                          value={option}
                          checked={answers[currentQuestion.id]?.includes(option) || false}
                          onChange={(e) => {
                            const current = answers[currentQuestion.id] || [];
                            const newValue = e.target.checked
                              ? [...current, option]
                              : current.filter((item) => item !== option);
                            handleAnswer(currentQuestion.id, newValue);
                          }}
                          className="mr-3 w-5 h-5 rounded"
                        />
                        <span className="text-gray-700 font-medium">{option}</span>
                      </label>
                    ))}
                  </div>
                )}

                {currentQuestion.type === "text" && (
                  <input
                    type="text"
                    placeholder={currentQuestion.placeholder}
                    value={answers[currentQuestion.id] || ""}
                    onChange={(e) => handleAnswer(currentQuestion.id, e.target.value)}
                    className="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-indigo-600 focus:outline-none text-lg"
                  />
                )}

                {currentQuestion.type === "number" && (
                  <input
                    type="number"
                    placeholder={currentQuestion.placeholder}
                    value={answers[currentQuestion.id] || ""}
                    onChange={(e) => handleAnswer(currentQuestion.id, e.target.value)}
                    className="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-indigo-600 focus:outline-none text-lg"
                  />
                )}
              </div>

              <div className="flex gap-4">
                {step > 0 && (
                  <button
                    onClick={handlePrevious}
                    className="flex-1 bg-gray-200 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-300 transition-colors"
                  >
                    ‚Üê Pr√©c√©dent
                  </button>
                )}
                <button
                  onClick={handleNext}
                  disabled={!isAnswered}
                  className="flex-1 bg-indigo-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-indigo-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"
                >
                  {step === questions.length - 1 ? "Voir les r√©sultats" : "Suivant ‚Üí"}
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<EligibilityTool />);
  </script>
</body>
</html>
